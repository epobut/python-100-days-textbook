[← Предыдущий урок](04.Операторы.md) | [Следующий урок →](06.Циклические_структуры.md)
---

## Ветвления

До сих пор все программы на Python, которые мы писали, выполнялись по одной инструкции последовательно сверху вниз. Такая структура называется последовательной. Но одной последовательной структуры недостаточно для всех задач: например, если в игре условие прохождения первого уровня — набрать 1000 очков, то после первого уровня нужно по результату или перейти ко второму уровню, или показать "Game Over". В такой ситуации код разветвляется и исполняется только одна ветка. Таких примеров полно — это и есть "ветвления" или "выбор". Подумай минуту и попробуй привести минимум 5 похожих примеров!

### Ветвления через if и else

В Python для ветвлений обычно используют ключевые слова `if`, `elif`, `else`. **Ключевые слова** — это специальные слова языка, их нельзя использовать как имена для переменных. Не всегда нужны сразу все три — рассмотрим на примере калькулятора индекса массы тела (BMI). Этот индекс — международный показатель для определения полноты и здоровья человека, рассчитывается по формуле ниже. Обычно считается, что $18.5 \le BMI < 24$ — норма, $BMI < 18.5$ — недостаток веса, $BMI \ge 24$ — лишний вес, $BMI \ge 27$ — ожирение.

$$
BMI = \frac{вес}{рост^{2}}
$$

> **Примечание**: Вес в кг, рост в метрах.

```Python
"""
Калькулятор BMI

Version: 1.0
Author: Ло Хао
"""
height = float(input('Рост (см):'))
weight = float(input('Вес (кг):'))
bmi = weight / (height / 100) ** 2
print(f'{bmi = :.1f}')
if 18.5 <= bmi < 24:
  print('У вас отличная фигура!')
```

> **Совет**: В конце строки с `if` — двоеточие, набирается на английской раскладке. Все спецсимволы вроде `'`, `"`, `=`, `(`, `)` — тоже на английской. Новички часто забывают это, тогда получат кучу ошибок. Внимательно читай описания ошибок, но **всегда включай английскую раскладку**, так намного меньше ошибок.

В приведенном коде после расчёта BMI идет ветвление, что если $18.5 \le BMI < 24$ — выводится "отличная фигура!", а иначе — ничего. Это и есть разный путь исполнения: не весь код гарантированно исполняется. В выражении `if 18.5 <= bmi < 24` — оператор сравнения возвращает булево значение, если оно `True`, то блок с четырьмя пробелами выполняется. Протестируем:

Первый набор входных данных:

```
Рост (см): 175
Вес (кг): 68
ИМТ = 22,2
У вас отличная фигура!
```

Второй набор входных данных:

```
Рост (см): 175
Вес (кг): 95
ИМТ = 31,0
```

Третий набор входных данных:

```
Рост (см): 175
Вес (кг): 50
ИМТ = 16,3
```

Только с первой группы BMI попадает в диапазон, срабатывает ветка if. В Python вместо фигурных скобок для блоков используется **отступ** (обычно 4 пробела, не Tab). Все строки с единым отступом — один блок и исполняются вместе. В других языках диапазон записывается через два условия и логическое "и", например, в Python так тоже можно: `if bmi >= 18.5 and bmi < 24:`, но `if 18.5 <= bmi < 24:` короче и понятнее. Вот Java-версия для сравнения:

```java
import java.util.Scanner;

class Test {
  public static void main(String[] args) {
    try (Scanner sc = new Scanner(System.in)) {
      System.out.print("Рост (см): ");
      double height = sc.nextDouble();
      System.out.print("Вес (кг): ");
      double weight = sc.nextDouble();
      double bmi = weight / Math.pow(height / 100, 2);
      System.out.printf("bmi = %.1f\n", bmi);
      if (bmi >= 18.5 && bmi < 24) {
        System.out.println("У вас отличная фигура!");
      }
    }
  }
}
```

> **Пояснение:** Это прямой перевод калькулятора BMI (версия 1.0) на Java. Многие любят Python из-за коротких решений.

Теперь модифицируем код: если BMI не входит в диапазон — выдать другой текст через блок else:

```Python
"""
Калькулятор BMI

Version: 1.1
Author: Ло Хао
"""
height = float(input('Рост (см):'))
weight = float(input('Вес (кг):'))
bmi = weight / (height / 100) ** 2
print(f'{bmi = :.1f}')
  if 18.5 <= bmi < 24:
print('У вас отличная фигура!')
  else:
print('Ваша фигура не совсем в норме!')

```

Если нужна более подробная разбивка, используем elif:

```Python
"""
Калькулятор BMI

Version: 1.2
Author: Ло Хао
"""
height = float(input('Рост (см):'))
weight = float(input('Вес (кг):'))
bmi = weight / (height / 100) ** 2
print(f'{bmi = :.1f}')
if bmi < 18.5:
  print('У вас недостаток веса!')
elif bmi < 24:
  print('У вас отличная фигура!')
elif bmi < 27:
  print('У вас лишний вес!')
elif bmi < 30:
  print('У вас лёгкое ожирение!')
elif bmi < 35:
  print('У вас умеренное ожирение!')
else:
  print('У вас тяжёлое ожирение!')

```

Проверяем три группы данных:

Первый набор входных данных:

```
Рост (см): 175
Вес (кг): 68
ИМТ = 22,2
У вас отличная фигура!
```

Второй набор входных данных:

```
Рост (см): 175
Вес (кг): 95
ИМТ = 31,0
У вас умеренная степень ожирения!
```

Третий набор входных данных:

```
Рост (см): 175
Вес (кг): 50
ИМТ = 16,3
У вас недостаточный вес!
```


### Ветвления через match и case

В Python 3.10 появился новый синтаксис для ветвлений — ключевые слова `match` и `case`. В официальной документации пример — определение описания по HTTP-коду ответа. Если не знаешь, что это — посмотри [вот тут](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status). Сначала вариант на if-else:

```Python
status_code = int(input('Код ответа: '))
if status_code == 400:
  description = 'Bad Request'
elif status_code == 401:
  description = 'Unauthorized'
elif status_code == 403:
  description = 'Forbidden'
elif status_code == 404:
  description = 'Not Found'
elif status_code == 405:
  description = 'Method Not Allowed'
elif status_code == 418:
  description = 'I am a teapot'
elif status_code == 429:
  description = 'Too many requests'
else:
  description = 'Unknown status Code'
  print('Описание:', description)

```

Результат:
```
Код ответа: 403
Описание: Forbidden
```

Вариант на match-case:

```Python
status_code = int(input('Код ответа: '))
match status_code:
  case 400: description = 'Bad Request'
  case 401: description = 'Unauthorized'
  case 403: description = 'Forbidden'
  case 404: description = 'Not Found'
  case 405: description = 'Method Not Allowed'
  case 418: description = 'I am a teapot'
  case 429: description = 'Too many requests'
  case _: description = 'Unknown Status Code'
  print('Описание:', description)

```

> **Пояснение:** case _ — это "подстановщик": если ни одна ветка не совпала, срабатывает он. Не обязательно указывать всегда; если есть, он должен быть последним.

Еще пример: можно объединять case. Например, коды 401,403,404 — в одну ветку, 400,405 — в другую:

```Python
status_code = int(input('Код ответа: '))
match status_code:
  case 400 | 405: description = 'Invalid Request'
  case 401 | 403 | 404: description = 'Not Allowed'
  case 418: description = 'I am a teapot'
  case 429: description = 'Too many requests'
  case _: description = 'Unknown Status Code'
  print('Описание:', description)
```

Результат:
```
Код ответа: 403
Описание: Not Allowed

```

### Примеры применения ветвлений

#### Пример 1: Вычисление значений по кусочной функции

Есть такая функция, надо по введённому `x` вычислить `y`:
$$
y = 
\begin{cases}
3x - 5, & (x > 1) \\
x + 2, & (-1 \le x \le 1) \\
5x + 3, & (x < -1)
\end{cases}
$$

```Python
"""
Вычисление по кусочной функции

Version: 1.0
Author: Ло Хао
"""
x = float(input('x = '))
if x > 1:
  y = 3 * x - 5
elif x >= -1:
  y = x + 2
else:
  y = 5 * x + 3
  print(f'{y = }')

```

По потребностям ветвления могут быть вложенными: внутри if, elif или else можно снова раскрывать условия. Например, внутри if после прохождения уровня можно оценить количество набранных предметов, и так далее. Вот вложенный вариант задачи с кусочной функцией:

```Python
"""
Вычисление по кусочной функции

Version: 1.1
Author: Ло Хао
"""
x = float(input('x = '))
if x > 1:
  y = 3 * x - 5
else:
  if x >= -1:
    y = x + 2
  else:
    y = 5 * x + 3
    print(f'{y = }')

```

> **Пояснение:** Выбор между вложенными и плоскими ветками решает читаемость: "Плоское лучше вложенного" (см. [Python Zen](https://zhuanlan.zhihu.com/p/111843067)). Много вложений портит читаемость — старайся использовать плоскую структуру.

#### Пример 2: Оценка по баллам

Если ввели балл 90 и выше — выводить `A`; 80–90 (не включая 90) — `B`; 70–80 — `C`; 60–70 — `D`; ниже 60 — `E`.

```Python
"""
Оценка по баллам

Version: 1.0
Author: Ло Хао
"""
score = float(input('Введите балл: '))
if score >= 90:
  grade = 'A'
elif score >= 80:
  grade = 'B'
elif score >= 70:
  grade = 'C'
elif score >= 60:
  grade = 'D'
else:
  grade = 'E'
  print(f'{grade = }')

```

#### Пример 3: Периметр и площадь треугольника

Ввести три стороны; если можно составить треугольник — вычислить периметр и площадь; иначе — "Не треугольник".

```Python
"""
Периметр и площадь треугольника

Version: 1.0
Author: Ло Хао
"""
a = float(input('a = '))
b = float(input('b = '))
c = float(input('c = '))
if a + b > c and a + c > b and b + c > a:
  perimeter = a + b + c
  print(f'Периметр: {perimeter}')
  s = perimeter / 2
  area = (s * (s - a) * (s - b) * (s - c)) ** 0.5
  print(f'Площадь: {area}')
else:
  print('Не треугольник')

```

> **Пояснение:** `if` проверяет, что любые две стороны больше третьей — это необходимое условие для существования треугольника. Формула площади — формула Герона: $A = \sqrt{s(s-a)(s-b)(s-c)}$, где $s = (a + b + c)/2$.

### Итоги

Теперь ты знаешь как строить ветвления и циклы в Python, можешь решать множество практических задач. Изучи ветвления и циклы — и напиши много классного кода! Продолжай!

---
[← Предыдущий урок](04.Операторы.md) | [Следующий урок →](06.Циклические_структуры.md)
