[← Предыдущий урок](06.Циклические_структуры.md) | [Следующий урок →](08.Списки-1.md)
---

## Практика ветвлений и циклических структур

Благодаря изучению предыдущих двух уроков, у вас уже сформировалось начальное понимание структур ветвления и циклических структур в Python. **Структуры ветвления и циклические структуры являются основой построения программной логики**, их важность не требует лишних слов, но для начинающих это также довольно сложная часть. Многие люди могут понять синтаксис структур ветвления и циклических структур, но когда сталкиваются с реальными задачами, не знают, с чего начать; **понять чужой код легко, но написать подобный код самостоятельно очень сложно**. Если у вас такая же проблема и замешательство, ни в коем случае не расстраивайтесь, это происходит только потому, что ваше программистское путешествие только начинается, **ваш объем практики еще не достиг уровня, позволяющего свободно писать код**, нужно лишь усилить практику программирования, и через накопление количества произойдет качественное изменение, эта проблема рано или поздно решится.

### Пример 1: Простые числа до 100

> **Примечание**: Простые числа — это положительные целые числа, которые делятся только на 1 и на себя (не включая 1). Ранее мы писали код для определения простых чисел, здесь это улучшенная версия.

```python
"""
Вывод простых чисел до 100

Version: 1.0
Author: 骆昊
"""
for num in range(2, 100):
    is_prime = True
    for i in range(2, int(num ** 0.5) + 1):
        if num % i == 0:
            is_prime = False
            break
    if is_prime:
        print(num)
```

### Пример 2: Последовательность Фибоначчи

Требование: Вывести первые 20 чисел последовательности Фибоначчи.

> **Примечание**: Последовательность Фибоначчи (Fibonacci sequence), обычно также называемая последовательностью золотого сечения, является числовой последовательностью, введенной итальянским математиком Леонардо Фибоначчи (Leonardo da Fibonacci) в книге «Liber Abaci» при изучении проблемы скорости роста кроликов в идеальных гипотетических условиях, поэтому эту последовательность часто в шутку называют "последовательностью кроликов". Особенность последовательности Фибоначчи в том, что первые два числа последовательности равны 1, начиная с третьего числа, каждое число является суммой двух предыдущих чисел. Согласно этому правилу, первые 10 чисел последовательности Фибоначчи: `1, 1, 2, 3, 5, 8, 13, 21, 34, 55`. Последовательность Фибоначчи имеет прямое применение в современной физике, структурах квазикристаллов, химии и других областях.

```python
"""
Вывод первых 20 чисел последовательности Фибоначчи

Version: 1.0
Author: 骆昊
"""

a, b = 0, 1
for _ in range(20):
    a, b = b, a + b
    print(a)
```

> **Примечание**: В приведенном выше цикле `a, b = b, a + b` означает присвоение значения переменной `b` переменной `a`, и присвоение значения `a + b` переменной `b`. С помощью этой рекуррентной формулы мы можем последовательно получать числа из последовательности Фибоначчи.

### Пример 3: Поиск чисел Армстронга (нарциссов)

Требование: Найти все числа Армстронга в диапазоне от 100 до 999.

> **Подсказка**: В теории чисел числа Армстронга (narcissistic number), также называемые плюс-совершенными числами, инвариантными цифровыми числами, нарциссическими числами, автоморфными числами, числами Армстронга — это $\small{N}$-значное неотрицательное целое число, сумма $\small{N}$-х степеней его цифр в точности равна самому числу, например: $\small{153 = 1^{3} + 5^{3} + 3^{3}}$, поэтому 153 — это число Армстронга; $\small{1634 = 1^{4} + 6^{4} + 3^{4} + 4^{4}}$, поэтому 1634 также является числом Армстронга. Для трехзначных чисел ключ к решению задачи — разделить число на единицы, десятки, сотни, а затем проверить, соответствует ли оно требованиям числа Армстронга. Это легко сделать, используя операторы `//` и `%` в Python.

```python
"""
Поиск чисел Армстронга в диапазоне от 100 до 999

Version: 1.0
Author: 骆昊
"""
for num in range(100, 1000):
    low = num % 10
    mid = num // 10 % 10
    high = num // 100
    if num == low ** 3 + mid ** 3 + high ** 3:
        print(num)
```

Приведенный выше прием разделения числа с использованием `//` и `%` довольно часто используется при написании кода. Если нужно перевернуть положительное целое число неизвестной длины, например, превратить 12389 в 98321, также можно использовать эти два оператора, код показан ниже.

```python
"""
Переворот положительного целого числа

Version: 1.0
Author: 骆昊
"""
num = int(input('num = '))
reversed_num = 0
while num > 0:
    reversed_num = reversed_num * 10 + num % 10
    num //= 10
print(reversed_num)
```

### Пример 4: Задача о ста монетах и ста курицах

> **Примечание**: "Сто монет — сто куриц" — математическая задача, предложенная древнекитайским математиком Чжан Цюцзянем в книге «Суаньцзин»: петух стоит пять монет, курица стоит три монеты, три цыпленка стоят одну монету. На сто монет купить сто куриц, сколько петухов, куриц и цыплят? Переводя на современный язык: петух стоит 5 юаней, курица 3 юаня, цыпленок 1 юань за трёх, за 100 юаней купить сто куриц, сколько петухов, куриц и цыплят?

```python
"""
Задача о ста монетах и ста курицах

Version: 1.0
Author: 骆昊
"""
for x in range(0, 21):
    for y in range(0, 34):
        for z in range(0, 100, 3):
            if x + y + z == 100 and 5 * x + 3 * y + z // 3 == 100:
                print(f'Петухов: {x} шт., Куриц: {y} шт., Цыплят: {z} шт.')
```

Приведенный выше метод называется **методом полного перебора**, также известным как **метод грубой силы**. Этот метод перечисляет все возможные кандидаты среди альтернативных решений и проверяет, соответствует ли каждый кандидат описанию задачи, в конечном итоге получая решение задачи. В приведенном выше коде мы использовали вложенную циклическую структуру, предполагая, что петухов `x`, очевидно, диапазон значений `x` от 0 до 20, предполагая, что куриц `y`, диапазон значений от 0 до 33, предполагая, что цыплят `z`, диапазон значений от 0 до 99 и значение кратно 3. Таким образом, мы устанавливаем условие для 100 куриц `x + y + z == 100`, устанавливаем условие для 100 юаней `5 * x + 3 * y + z // 3 == 100`, когда оба условия выполняются одновременно, это правильный ответ на задачу, мы выводим его с помощью функции `print`. Этот метод выглядит довольно неуклюжим, но для компьютера с очень мощными вычислительными возможностями обычно это выполнимый и даже неплохой выбор, если решение задачи существует, оно будет найдено.

На самом деле, приведенный выше код можно написать лучше. Поскольку мы уже предположили, что петухов `x`, куриц `y`, то количество цыплят должно быть `100 - x - y`. Таким образом, убрав одно условие, мы можем переписать три вложенных цикла `for-in` в два вложенных цикла `for-in`. Количество итераций уменьшилось, эффективность выполнения кода значительно повысилась, как показано ниже.

```python
"""
Задача о ста монетах и ста курицах

Version: 1.1
Author: 骆昊
"""
for x in range(0, 21):
    for y in range(0, 34):
        z = 100 - x - y
        if z % 3 == 0 and 5 * x + 3 * y + z // 3 == 100:
            print(f'Петухов: {x} шт., Куриц: {y} шт., Цыплят: {z} шт.')
```

> **Примечание**: `z % 3 == 0` в приведенном выше коде нужно для того, чтобы убедиться, что количество цыплят кратно 3.

### Пример 5: Азартная игра CRAPS

> **Примечание**: CRAPS, также называемая крэпс, — очень популярная настольная азартная игра в Лас-Вегасе, США. В игре используются две кости, игроки получают очки, бросая две кости. Упрощенные правила следующие: если игрок при первом броске выбросил 7 или 11 очков, игрок побеждает; если игрок при первом броске выбросил 2, 3 или 12 очков, побеждает крупье; если игрок выбросил другое количество очков, игра продолжается, игрок снова бросает кости, если игрок выбросил 7 очков, побеждает крупье; если игрок выбросил количество очков из первого броска, игрок побеждает; при других очках игрок продолжает бросать кости до определения победителя. Чтобы сделать код более интересным, мы установили, что в начале игры у игрока есть 1000 юаней ставки, перед началом каждой игры игрок делает ставку, если игрок побеждает, он может получить награду в соответствии с суммой ставки, если побеждает крупье, игрок теряет сумму своей ставки. Условие окончания игры — банкротство игрока (потеря всех ставок).

```python
"""
Азартная игра Craps

Version: 1.0
Author: 骆昊
"""
import random

money = 1000
while money > 0:
    print(f'Ваши общие активы: {money} юаней')
    # Сумма ставки должна быть больше 0 и меньше или равна общим активам игрока
    while True:
        debt = int(input('Сделайте ставку: '))
        if 0 < debt <= money:
            break
    # Используем сумму двух равномерно распределенных случайных чисел от 1 до 6 для симуляции броска двух костей
    first_point = random.randrange(1, 7) + random.randrange(1, 7)
    print(f'\nИгрок выбросил {first_point} очков')
    if first_point == 7 or first_point == 11:
        print('Игрок победил!\n')
        money += debt
    elif first_point == 2 or first_point == 3 or first_point == 12:
        print('Крупье победил!\n')
        money -= debt
    else:
        # Если первый бросок не определил победителя, игрок должен снова бросить кости
        while True:
            current_point = random.randrange(1, 7) + random.randrange(1, 7)
            print(f'Игрок выбросил {current_point} очков')
            if current_point == 7:
                print('Крупье победил!\n')
                money -= debt
                break
            elif current_point == first_point:
                print('Игрок победил!\n')
                money += debt
                break
print('Вы обанкротились, игра окончена!')
```

### Заключение

Структуры ветвления и циклические структуры очень важны, они являются основой построения программной логики, **обязательно нужно через большое количество практики достичь полного понимания**. Мы можем использовать описанную выше игру в крэпс как стандарт: если вы можете очень гладко завершить этот код, значит, вы уже хорошо освоили знания о структурах ветвления и циклических структурах.

---
[← Предыдущий урок](06.Циклические_структуры.md) | [Следующий урок →](08.Списки-1.md)
